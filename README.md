# 数据库准备

```sql
CREATE SCHEMA `data_visualization` DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
CREATE USER 'data_visualization'@'%' IDENTIFIED BY 'data_visualization';
GRANT ALL PRIVILEGES ON `data_visualization`.* TO 'data_visualization'@'%' WITH GRANT OPTION;
```

# 依赖安装

```bash
pip install -r requirements.txt
```

# 项目启动

运行 main.py

# 接口使用说明

### 1. 测试服务可用

GET http://127.0.0.1:5001/sysinfo/test

### 2. 提供数据源

直接向接口提供绘图所需数据

POST http://127.0.0.1:5001/plot/source/two

##### 示例1

请求体：

```json
{
  "plot_title": "订单量",
  "data_source_1": ["工人1", "工人2", "工人3", "工人4", "工人5", "工人6", "工人7"],
  "data_source_2": [1, 2, 3, 4, 5, 6, 7]
}
```

响应

```json
{
    "code": 0,
    "data": "021df058-6350-42d3-8a09-ca4ae24309a7",
    "msg": "1:折线图,2:柱状图,3:条形图,4:饼状图,5:雷达图"
}
```

##### 示例2

请求体：

```json
{
  "plot_title": "订单量",
  "data_source_1": ["07-03", "07-04", "07-05", "07-06", "07-07", "07-08", "07-09", "07-10", "07-11", "07-12"],
  "data_source_2": [123, 32, 85, 93, 73, 88, 94, 83, 88, 79]
}
```

响应

```json
{
    "code": 0,
    "data": "f5b49d3c-0504-402b-bdd8-ea0dfaf1199d",
    "msg": "1:折线图,2:柱状图"
}
```

##### 示例3

请求体

```json
{
  "plot_title": "订单量",
  "time_data_list": ["工人1", "工人2", "工人3", "工人4", "工人5", "工人6", "工人7"],
  "num_data_list": [1, 2, 3, 4, 5, 6, 7, 8]
}
```

响应

```json
{
    "code": 2,
    "data": null,
    "msg": "两个数据序列长度不一致"
}
```

##### 示例4

请求体

```json
{
  "plot_title": "订单量",
  "data_source_1": ["07-03", "07-04", "07-05", "07-06", "07-07", "07-08", "07-09", "07-10", "07-11", "07-12"],
  "data_source_2": {
    "工人1": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10],
    "工人2": [15, 2, 4, 5, 7, 1, 2, 33, 45, 77],
    "工人3": [17, 16, 44, 32, 56, 7, 9, 12, 33, 32],
    "工人4": [12, 66, 89, 3, 67, 12, 44, 78, 55, 21],
    "工人5": [88, 32, 15, 31, 51, 66, 9, 3, 9, 43],
    "工人6": [5, 3, 12, 22, 90, 75, 12, 36, 99, 32]
  }
}
```

响应

```json
{
    "code": 0,
    "data": "af89870c-c197-416b-b411-a9998ab0379d",
    "msg": "6:多条折线图"
}
```

##### 示例5

请求体

```json
{
  "plot_title": "订单量",
  "data_source_1": ["07-03", "07-04", "07-05", "07-06", "07-07", "07-08", "07-09", "07-10", "07-11", "07-12"],
  "data_source_2": {
    "工人1": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10],
    "工人2": [15, 2, 4, 5, 7, 1, 2, 33, 45, 77],
    "工人3": [17, 16, 44, 32, 56, 7, 9, 12, 33, 32]
  }
}
```

响应

```json
{
    "code": 0,
    "data": "f9754f3e-723b-4cf7-938a-214c4f9eedcf",
    "msg": "7:并列柱状图"
}
```

##### 示例6

请求体

```json
{
  "plot_title": "订单量",
  "data_source_1": ["07-03", "07-04", "07-05", "07-06", "07-07", "07-08", "07-09", "07-10", "07-11", "07-12"],
  "data_source_2": {
    "工人1": [1, 2, 3, 4, 5, 6],
    "工人2": [15, 2, 4, 5, 33, 77],
    "工人3": [17, 16, 44, 32, 12, 32]
  }
}
```

响应

```json
{
    "code": 2,
    "data": null,
    "msg": "两个数据序列长度不一致"
}
```

##### 示例7

请求体

```json
{
  "plot_title": "订单量",
  "data_source_1": ["07-03", "07-04", "07-05", "07-06", "07-07", "07-08", "07-09", "07-10", "07-11", "07-12"],
  "data_source_2": {
    "工人1": [1, 2, 3, 4, 5, 6, 7],
    "工人2": [1, 2, 3, 4, 5, 6, 7, 8],
    "工人3": [1, 2, 3, 4, 5, 6, 7]
  }
}
```

响应

```json
{
    "code": 1,
    "data": null,
    "msg": "数据源结构无效"
}
```

### 3. 绘图

向绘图接口提交两个参数：

1. plot_key: 提供数据源接口返回的plot_key
```json
{
    "code": 0,
    "data": "f9754f3e-723b-4cf7-938a-214c4f9eedcf",   <-----这个就是plot_key
    "msg": "7:并列柱状图"
}
```

2. plot_requirement_list: 绘图要求列表，形式如下

* `[]`
* `['1']`
* `['1', '2', '3']`

##### 示例1

请求体

```json
{
    "plot_key": "7548c068-a888-4bb2-a7b1-739385a60f06",
    "plot_requirement_list": ["1","2","3"]
}
```

响应

```json
{
  "code": 0,
  "data": "192.168.64.17:9001/py-data-visualization/4aa87880-78ed-4115-bf51-05ef574964d2.png",
  "msg": "绘图成功"
}
```

##### 示例2

请求体

```json
{
    "plot_key": "7548c068-a888-4bb2-a7b1-739385a60f06",
    "plot_requirement_list": []
}
```

响应

```json
{
    "code": 500,
    "data": null,
    "msg": "请求数据无效"
}
```

##### 示例3

请求体

```json
{
    "plot_key": "",
    "plot_requirement_list": ["1"]
}
```

响应

```json
{
    "code": 500,
    "data": null,
    "msg": "plot_key无效"
}
```